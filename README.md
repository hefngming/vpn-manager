# ğŸ¦ å°é¾™è™¾VPN - åŠ é€Ÿå™¨æ¨¡å¼è®¢é˜…ç³»ç»Ÿ

ä¸€ä¸ªç±»ä¼¼å•†ä¸š VPN åŠ é€Ÿå™¨çš„è®¢é˜…ç®¡ç†ç³»ç»Ÿï¼Œç”¨æˆ·æ— éœ€æ¥è§¦ä»»ä½•æŠ€æœ¯é…ç½®ï¼Œé€šè¿‡å®¢æˆ·ç«¯åº”ç”¨ä¸€é”®è¿æ¥ã€‚

## âœ¨ ç³»ç»Ÿæ¨¡å¼

### ğŸ”’ åŠ é€Ÿå™¨æ¨¡å¼ (Accelerator Mode)
- âœ… ç”¨æˆ·çœ‹ä¸åˆ°ä»»ä½•èŠ‚ç‚¹é“¾æ¥æˆ–é…ç½®æ–‡ä»¶
- âœ… å®¢æˆ·ç«¯åº”ç”¨ä»åå°è·å–åŠ å¯†é…ç½®
- âœ… ä¸€é”®è¿æ¥/æ–­å¼€ï¼Œç±»ä¼¼ ExpressVPN/NordVPN
- âœ… æ”¯æŒæ¡Œé¢å’Œç§»åŠ¨å®¢æˆ·ç«¯å¼€å‘

### ğŸŒ Web ç®¡ç†é¢æ¿
- âœ… æŸ¥çœ‹æµé‡ä½¿ç”¨æƒ…å†µ
- âœ… èŠ‚ç‚¹çŠ¶æ€ç›‘æ§
- âœ… ç®¡ç†å‘˜èŠ‚ç‚¹ç®¡ç†
- âœ… ç”Ÿæˆ Clash/V2Ray è®¢é˜…é“¾æ¥

## ğŸ—ï¸ æ¶æ„è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        å®¢æˆ·ç«¯åº”ç”¨                             â”‚
â”‚  (Electron/Flutter/React Native/æ¡Œé¢ç¨‹åº)                     â”‚
â”‚                    ç”¨æˆ·çœ‹åˆ°: èŠ‚ç‚¹åç§° + è¿æ¥æŒ‰é’®                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚ HTTPS API
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      åç«¯æœåŠ¡ (Node.js)                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚  è®¤è¯æœåŠ¡    â”‚  â”‚  èŠ‚ç‚¹ç®¡ç†    â”‚  â”‚  æµé‡æ§åˆ¶    â”‚          â”‚
â”‚  â”‚  /auth/*    â”‚  â”‚ /api/client â”‚  â”‚ /api/trafficâ”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                       â”‚ åŠ å¯†é…ç½®å­˜å‚¨ (AES-256-GCM)            â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æ•°æ®åº“ (SQLite/PostgreSQL)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### å·²å®ç°åŠŸèƒ½

#### ğŸ” åŠ é€Ÿå™¨æ¨¡å¼ API
- âœ… `/api/client/nodes` - è·å–èŠ‚ç‚¹åˆ—è¡¨ (ä»…å…ƒæ•°æ®ï¼Œæ— é…ç½®)
- âœ… `/api/client/connect` - è¿æ¥èŠ‚ç‚¹ (è¿”å›è§£å¯†åçš„é…ç½®)
- âœ… `/api/client/subscription-config` - Clash è®¢é˜…é…ç½®

#### ğŸ‘¤ ç”¨æˆ·ç³»ç»Ÿ
- âœ… ç”¨æˆ·æ³¨å†Œ/ç™»å½• (JWT)
- âœ… æµé‡é™åˆ¶æ§åˆ¶ (å…è´¹ç”¨æˆ· 1GB/å¤©)
- âœ… å¥—é¤ tier ç®¡ç† (FREE/PAID)

#### ğŸ–¥ï¸ Web ç•Œé¢
- âœ… åŠ é€Ÿå™¨é£æ ¼ UI (æ·±è‰²ä¸»é¢˜)
- âœ… ä¸€é”®è¿æ¥/æ–­å¼€
- âœ… å®æ—¶æµé‡æ˜¾ç¤º
- âœ… èŠ‚ç‚¹å»¶è¿Ÿå’Œè´Ÿè½½æ˜¾ç¤º

#### ğŸ”§ ç®¡ç†åŠŸèƒ½
- âœ… èŠ‚ç‚¹ CRUD ç®¡ç†
- âœ… é…ç½®åŠ å¯†å­˜å‚¨
- âœ… æµé‡æ—¥å¿—è®°å½•

### å¾…å®Œå–„åŠŸèƒ½

#### å®¢æˆ·ç«¯å¼€å‘
- â³ Electron æ¡Œé¢å®¢æˆ·ç«¯
- â³ Flutter ç§»åŠ¨ç«¯åº”ç”¨
- â³ ç³»ç»Ÿé›†æˆ (ç³»ç»Ÿä»£ç†/VPN)

#### æ”¯ä»˜ç³»ç»Ÿ
- â³ å¥—é¤è´­ä¹° (Stripe/æ”¯ä»˜å®/å¾®ä¿¡)
- â³ è‡ªåŠ¨ç»­è´¹
- â³ é‚€è¯·è¿”åˆ©

#### é«˜çº§åŠŸèƒ½
- â³ èŠ‚ç‚¹å¥åº·æ£€æŸ¥
- â³ æ™ºèƒ½è·¯ç”± (è‡ªåŠ¨é€‰æ‹©æœ€ä¼˜èŠ‚ç‚¹)
- â³ åˆ†åº”ç”¨ä»£ç†
- â³ Kill Switch

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Node.js 20+
- Docker & Docker Compose (æ¨è)

### æœ¬åœ°å¼€å‘

```bash
# 1. å…‹éš†ä»“åº“
git clone https://github.com/hefngming/vpn-manager.git
cd vpn-manager

# 2. å®‰è£…ä¾èµ–
cd backend && npm install
cd ../frontend && npm install

# 3. é…ç½®ç¯å¢ƒå˜é‡
cp backend/.env.example backend/.env
# ç¼–è¾‘ backend/.envï¼Œè®¾ç½®ä½ çš„å¯†é’¥

# 4. åˆå§‹åŒ–æ•°æ®åº“
cd backend
npx prisma migrate dev
npx prisma generate

# 5. å¯åŠ¨æœåŠ¡
npm run dev  # åç«¯
# æ–°ç»ˆç«¯
cd frontend && npm run dev  # å‰ç«¯
```

è®¿é—® http://localhost:5173

### Docker éƒ¨ç½²

```bash
# 1. é…ç½®ç¯å¢ƒå˜é‡
cp .env.example .env
# ç¼–è¾‘ .envï¼Œè®¾ç½®å¼ºå¯†é’¥

# 2. å¯åŠ¨æœåŠ¡
docker-compose up -d

# 3. æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
.
â”œâ”€â”€ backend/                    # åç«¯ API æœåŠ¡
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.ts        # è®¤è¯è·¯ç”±
â”‚   â”‚   â”‚   â”œâ”€â”€ client.ts      # ğŸ†• åŠ é€Ÿå™¨æ¨¡å¼ API
â”‚   â”‚   â”‚   â”œâ”€â”€ admin.ts       # ç®¡ç†è·¯ç”±
â”‚   â”‚   â”‚   â””â”€â”€ traffic.ts     # æµé‡ç»Ÿè®¡
â”‚   â”‚   â”œâ”€â”€ middleware/
â”‚   â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â””â”€â”€ app.ts
â”‚   â””â”€â”€ prisma/
â”œâ”€â”€ frontend/                   # Web å‰ç«¯
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”‚   â”œâ”€â”€ ClientDashboard.tsx  # ğŸ†• åŠ é€Ÿå™¨ç•Œé¢
â”‚   â”‚   â”‚   â”œâ”€â”€ Login.tsx
â”‚   â”‚   â”‚   â””â”€â”€ Admin.tsx
â”‚   â”‚   â””â”€â”€ App.tsx
â”‚   â””â”€â”€ Dockerfile
â”œâ”€â”€ client-example/             # ğŸ†• å®¢æˆ·ç«¯å¼€å‘ç¤ºä¾‹
â”‚   â”œâ”€â”€ vpn_client.py          # Python ç¤ºä¾‹å®¢æˆ·ç«¯
â”‚   â””â”€â”€ README.md              # å®¢æˆ·ç«¯å¼€å‘æŒ‡å—
â”œâ”€â”€ docker-compose.yml
â””â”€â”€ README.md
```

## ğŸ”Œ API æ–‡æ¡£

### åŠ é€Ÿå™¨æ¨¡å¼ API

#### 1. è·å–èŠ‚ç‚¹åˆ—è¡¨
```
GET /api/client/nodes
Authorization: Bearer {token}
```

**å“åº”:**
```json
{
  "user": {
    "email": "user@example.com",
    "planType": "FREE",
    "dailyUsage": "1000000",
    "dailyLimit": 1073741824,
    "remainingBytes": 1072741824
  },
  "nodes": [
    {
      "id": "uuid",
      "displayName": "é¦™æ¸¯èŠ‚ç‚¹ 01",
      "countryCode": "HK",
      "latency": 45,
      "load": 30
    }
  ]
}
```

#### 2. è¿æ¥èŠ‚ç‚¹
```
POST /api/client/connect
Authorization: Bearer {token}
Content-Type: application/json

{
  "nodeId": "node-uuid"
}
```

**å“åº”:**
```json
{
  "success": true,
  "node": {
    "id": "node-uuid",
    "name": "é¦™æ¸¯èŠ‚ç‚¹ 01",
    "countryCode": "HK"
  },
  "config": {
    "server": "hk.example.com",
    "port": 443,
    "method": "aes-256-gcm",
    "password": "***",
    "type": "ss"
  }
}
```

#### 3. Clash è®¢é˜…
```
GET /api/client/subscription-config
Authorization: Bearer {token}
```

è¿”å› YAML æ ¼å¼çš„ Clash é…ç½®

## ğŸ’» å®¢æˆ·ç«¯å¼€å‘

### ç¤ºä¾‹å®¢æˆ·ç«¯

æä¾›äº† Python å‘½ä»¤è¡Œç¤ºä¾‹ (`client-example/vpn_client.py`)ï¼š

```bash
cd client-example
python vpn_client.py
```

æ¼”ç¤ºå®Œæ•´æµç¨‹ï¼š
1. ç”¨æˆ·ç™»å½•
2. è·å–èŠ‚ç‚¹åˆ—è¡¨
3. é€‰æ‹©èŠ‚ç‚¹è¿æ¥
4. è·å–è§£å¯†é…ç½®

### çœŸå®å®¢æˆ·ç«¯å¼€å‘

**æŠ€æœ¯æ ˆå»ºè®®:**
- **æ¡Œé¢**: Electron + React æˆ– Tauri
- **ç§»åŠ¨**: Flutter æˆ– React Native
- **ç³»ç»Ÿä»£ç†**: é›†æˆ Clash æ ¸å¿ƒæˆ– shadowsocks-libev

**æ ¸å¿ƒæµç¨‹:**
```
ç”¨æˆ·æ‰“å¼€å®¢æˆ·ç«¯
    â†“
ç™»å½•/æ³¨å†Œ â†’ è·å– JWT Token
    â†“
æ˜¾ç¤ºèŠ‚ç‚¹åˆ—è¡¨ (åç§°ã€å»¶è¿Ÿã€è´Ÿè½½)
    â†“
ç”¨æˆ·ç‚¹å‡»"è¿æ¥"
    â†“
è°ƒç”¨ /api/client/connect è·å–é…ç½®
    â†“
å®¢æˆ·ç«¯ä½¿ç”¨é…ç½®å»ºç«‹ VPN/ä»£ç†è¿æ¥
    â†“
æ˜¾ç¤ºè¿æ¥çŠ¶æ€ + å®æ—¶æµé‡
```

è¯¦è§ `client-example/README.md`

## ğŸ” å®‰å…¨é…ç½®

### å¿…æ”¹é¡¹
```env
# 32å­—ç¬¦åŠ å¯†å¯†é’¥
ENCRYPTION_KEY="your-32-char-encryption-key-here!!"

# JWT ç­¾åå¯†é’¥  
JWT_SECRET="your-super-secret-jwt-key-change-this!!!"
```

### ç”Ÿäº§ç¯å¢ƒå»ºè®®
1. âœ… ä½¿ç”¨ HTTPS
2. âœ… å¯ç”¨é˜²ç«å¢™ (åªå¼€æ”¾ 80/443)
3. âœ… å®šæœŸå¤‡ä»½æ•°æ®åº“
4. âœ… é…ç½®æ—¥å¿—ç›‘æ§
5. âœ… ä½¿ç”¨ PostgreSQL æ›¿ä»£ SQLite

## ğŸŒ éƒ¨ç½²é…ç½®

### åŸŸå: `dj.siumingho.dpdns.org`

**Nginx é…ç½®:**
```nginx
server {
    listen 80;
    server_name dj.siumingho.dpdns.org;
    
    location / {
        proxy_pass http://localhost:80;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }
}
```

**SSL (Certbot):**
```bash
certbot --nginx -d dj.siumingho.dpdns.org
```

## ğŸ“Š å½“å‰çŠ¶æ€

| ç»„ä»¶ | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| åç«¯ API | âœ… å®Œæˆ | åŠ é€Ÿå™¨æ¨¡å¼ API å·²å®ç° |
| Web å‰ç«¯ | âœ… å®Œæˆ | åŠ é€Ÿå™¨é£æ ¼ç•Œé¢ |
| æ•°æ®åº“ | âœ… å®Œæˆ | SQLiteï¼Œæ”¯æŒè¿ç§»åˆ° PostgreSQL |
| Docker | âœ… å®Œæˆ | å®Œæ•´å®¹å™¨åŒ–é…ç½® |
| æ¡Œé¢å®¢æˆ·ç«¯ | â³ å¾…å¼€å‘ | éœ€è¦ Electron æˆ– Tauri |
| ç§»åŠ¨å®¢æˆ·ç«¯ | â³ å¾…å¼€å‘ | éœ€è¦ Flutter |

## ğŸ› å·²çŸ¥é—®é¢˜

1. Web ç•Œé¢æ— æ³•ç›´æ¥å»ºç«‹ VPN è¿æ¥ï¼ˆæµè§ˆå™¨é™åˆ¶ï¼‰ï¼Œéœ€è¦é…åˆæ¡Œé¢å®¢æˆ·ç«¯ä½¿ç”¨
2. æµé‡ä¸ŠæŠ¥éœ€è¦å®¢æˆ·ç«¯ä¸»åŠ¨è°ƒç”¨ API
3. èŠ‚ç‚¹å»¶è¿Ÿæ˜¯æ¨¡æ‹Ÿæ•°æ®ï¼Œéœ€è¦æ¥å…¥çœŸå®å¥åº·æ£€æŸ¥

## ğŸ“‹ ä¸‹ä¸€æ­¥å¼€å‘

1. **å¼€å‘æ¡Œé¢å®¢æˆ·ç«¯** (Electron)
   - åŒ…è£… Web å‰ç«¯
   - æ·»åŠ ç³»ç»Ÿä»£ç†åŠŸèƒ½
   - é›†æˆ Clash æ ¸å¿ƒ

2. **æ·»åŠ èŠ‚ç‚¹å¥åº·æ£€æŸ¥**
   - å®šæ—¶ ping æµ‹è¯•
   - è‡ªåŠ¨æ•…éšœè½¬ç§»

3. **é›†æˆæ”¯ä»˜ç³»ç»Ÿ**
   - Stripe / æ”¯ä»˜å® / å¾®ä¿¡
   - è‡ªåŠ¨å¼€é€šå¥—é¤

4. **ä¼˜åŒ–æµé‡ç»Ÿè®¡**
   - å®æ—¶ WebSocket æ¨é€
   - æµé‡é¢„è­¦é€šçŸ¥

## ğŸ‘¨â€ğŸ’» å¼€å‘è€…

- **ç›‘ç£è€…**: ğŸ¦ å°é¾™è™¾ (AI ç›‘ç£è€… + ç®¡å®¶)
- **å¼€å‘è€…**: ä½•

## ğŸ“„ è®¸å¯è¯

MIT License

---

_ğŸ¦ å°é¾™è™¾VPN - è®©ç¿»å¢™å˜å¾—ç®€å•_
