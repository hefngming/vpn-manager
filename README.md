# ğŸ¦ å°é¾™è™¾VPN - è®¢é˜…ç®¡ç†ç³»ç»Ÿ

ä¸€ä¸ªç®€å•ã€é«˜æ•ˆçš„VPNè®¢é˜…ç®¡ç†é¢æ¿ï¼Œæ”¯æŒå¤šç”¨æˆ·ã€æµé‡ç»Ÿè®¡å’ŒèŠ‚ç‚¹ç®¡ç†ã€‚

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### å·²å®ç°åŠŸèƒ½

#### ç”¨æˆ·ç³»ç»Ÿ
- âœ… ç”¨æˆ·æ³¨å†Œ/ç™»å½•
- âœ… JWTèº«ä»½è®¤è¯
- âœ… å¯†ç åŠ å¯†å­˜å‚¨ (bcryptjs)

#### è®¢é˜…ç®¡ç†
- âœ… ç”¨æˆ·è®¢é˜…ä¿¡æ¯æŸ¥è¯¢
- âœ… èŠ‚ç‚¹é…ç½®è‡ªåŠ¨è§£å¯†
- âœ… å…è´¹/ä»˜è´¹ tier åŒºåˆ†

#### æµé‡ç»Ÿè®¡
- âœ… æ¯æ—¥æµé‡ç»Ÿè®¡
- âœ… æµé‡é™åˆ¶æ§åˆ¶ (å…è´¹ç”¨æˆ·1GB/å¤©)
- âœ… æµé‡æ—¥å¿—è®°å½•

#### ç®¡ç†å‘˜åŠŸèƒ½
- âœ… èŠ‚ç‚¹ç®¡ç† (CRUD)
- âœ… èŠ‚ç‚¹ä¼˜å…ˆçº§æ’åº
- âœ… èŠ‚ç‚¹æ¿€æ´»/åœç”¨

#### æŠ€æœ¯ç‰¹æ€§
- âœ… TypeScript å…¨æ ˆå¼€å‘
- âœ… Prisma ORM + SQLite
- âœ… RESTful API
- âœ… é…ç½®åŠ å¯†å­˜å‚¨ (AES-256-GCM)
- âœ… Docker å®¹å™¨åŒ–éƒ¨ç½²

### å¾…å®Œå–„åŠŸèƒ½

#### ç”¨æˆ·ç³»ç»Ÿå¢å¼º
- â³ é‚®ç®±éªŒè¯
- â³ å¯†ç é‡ç½®
- â³ ç”¨æˆ·èµ„æ–™ç®¡ç†
- â³ ç¬¬ä¸‰æ–¹ç™»å½• (Google/GitHub)

#### æ”¯ä»˜é›†æˆ
- â³ ä»˜è´¹å¥—é¤è´­ä¹°
- â³ æ”¯ä»˜ç½‘å…³é›†æˆ (Stripe/æ”¯ä»˜å®/å¾®ä¿¡)
- â³ è®¢å•ç®¡ç†
- â³ è‡ªåŠ¨ç»­è´¹

#### èŠ‚ç‚¹ç®¡ç†å¢å¼º
- â³ èŠ‚ç‚¹å¥åº·æ£€æŸ¥
- â³ è‡ªåŠ¨æ•…éšœè½¬ç§»
- â³ èŠ‚ç‚¹è´Ÿè½½å‡è¡¡
- â³ åœ°ç†ä½ç½®è‡ªåŠ¨è¯†åˆ«

#### æµé‡ä¸ç»Ÿè®¡
- â³ å®æ—¶æµé‡å›¾è¡¨
- â³ å†å²æµé‡åˆ†æ
- â³ ç”¨æˆ·è¡Œä¸ºç»Ÿè®¡
- â³ å¼‚å¸¸æµé‡æ£€æµ‹

#### å®¢æˆ·ç«¯æ”¯æŒ
- â³ Clash é…ç½®è®¢é˜…
- â³ V2Ray é…ç½®è®¢é˜…
- â³ Shadowrocket é…ç½®
- â³ ä¸€é”®å¯¼å…¥åŠŸèƒ½

#### ç®¡ç†åå°
- â³ ç”¨æˆ·ç®¡ç†é¢æ¿
- â³ æµé‡æŠ¥è¡¨å¯¼å‡º
- â³ ç³»ç»Ÿè®¾ç½®ç•Œé¢
- â³ é€šçŸ¥æ¨é€

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Node.js 20+
- Docker & Docker Compose (æ¨è)

### æœ¬åœ°å¼€å‘

```bash
# å…‹éš†ä»“åº“
git clone <your-repo-url>
cd xiaolonglong-vpn

# å®‰è£…ä¾èµ–
cd backend && npm install
cd ../frontend && npm install

# é…ç½®ç¯å¢ƒå˜é‡
cp backend/.env.example backend/.env
# ç¼–è¾‘ backend/.envï¼Œè®¾ç½®ä½ çš„å¯†é’¥

# åˆå§‹åŒ–æ•°æ®åº“
cd backend
npx prisma migrate dev
npx prisma generate

# å¯åŠ¨åç«¯ (å¼€å‘æ¨¡å¼)
npm run dev

# å¯åŠ¨å‰ç«¯ (æ–°ç»ˆç«¯)
cd frontend
npm run dev
```

è®¿é—® http://localhost:5173

### Docker éƒ¨ç½²

```bash
# é…ç½®ç¯å¢ƒå˜é‡
cp .env.example .env
# ç¼–è¾‘ .envï¼Œè®¾ç½®å¼ºå¯†é’¥

# å¯åŠ¨æœåŠ¡
docker-compose up -d

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
.
â”œâ”€â”€ backend/                 # åç«¯ API æœåŠ¡
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ routes/         # API è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ middleware/     # ä¸­é—´ä»¶
â”‚   â”‚   â”œâ”€â”€ utils/          # å·¥å…·å‡½æ•°
â”‚   â”‚   â””â”€â”€ app.ts          # åº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ prisma/
â”‚   â”‚   â””â”€â”€ schema.prisma   # æ•°æ®åº“æ¨¡å‹
â”‚   â””â”€â”€ Dockerfile
â”œâ”€â”€ frontend/                # å‰ç«¯ React åº”ç”¨
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ pages/          # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ components/     # é€šç”¨ç»„ä»¶
â”‚   â”‚   â””â”€â”€ App.tsx         # åº”ç”¨å…¥å£
â”‚   â””â”€â”€ Dockerfile
â”œâ”€â”€ docker-compose.yml       # Docker ç¼–æ’
â””â”€â”€ README.md
```

## ğŸ” å®‰å…¨é…ç½®

### å¿…æ”¹é¡¹
éƒ¨ç½²å‰åŠ¡å¿…ä¿®æ”¹ä»¥ä¸‹é…ç½®ï¼š

```env
# 32å­—ç¬¦åŠ å¯†å¯†é’¥
ENCRYPTION_KEY="your-32-char-encryption-key-here!!"

# JWT ç­¾åå¯†é’¥
JWT_SECRET="your-super-secret-jwt-key-change-this!!!"
```

### å®‰å…¨å»ºè®®
1. ä½¿ç”¨ HTTPS éƒ¨ç½²
2. é…ç½®é˜²ç«å¢™è§„åˆ™
3. å®šæœŸæ›´æ¢å¯†é’¥
4. å¯ç”¨æ•°æ®åº“å¤‡ä»½
5. é…ç½®æ—¥å¿—ç›‘æ§

## ğŸŒ åŸŸåé…ç½®

ä½ çš„åŸŸå: `dj.siumingho.dpdns.org`

éƒ¨ç½²åé…ç½® Nginx åå‘ä»£ç†ï¼š

```nginx
server {
    listen 80;
    server_name dj.siumingho.dpdns.org;
    
    location / {
        proxy_pass http://localhost:80;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

æˆ–ä½¿ç”¨ Cloudflare Tunnel è¿›è¡Œå¿«é€Ÿéƒ¨ç½²ã€‚

## ğŸ“ API æ–‡æ¡£

### è®¤è¯ç›¸å…³
- `POST /auth/register` - ç”¨æˆ·æ³¨å†Œ
- `POST /auth/login` - ç”¨æˆ·ç™»å½•

### è®¢é˜…ç›¸å…³
- `GET /api/subscription` - è·å–è®¢é˜…ä¿¡æ¯ (éœ€è®¤è¯)

### æµé‡ç›¸å…³
- `GET /api/traffic/usage` - è·å–æµé‡ä½¿ç”¨ (éœ€è®¤è¯)
- `POST /api/traffic/report` - ä¸ŠæŠ¥æµé‡ (éœ€è®¤è¯)

### ç®¡ç†ç›¸å…³
- `GET /admin/nodes` - åˆ—å‡ºæ‰€æœ‰èŠ‚ç‚¹ (éœ€ç®¡ç†å‘˜)
- `POST /admin/nodes` - åˆ›å»ºèŠ‚ç‚¹ (éœ€ç®¡ç†å‘˜)

## ğŸ”§ ç»´æŠ¤å‘½ä»¤

```bash
# æ•°æ®åº“è¿ç§»
cd backend
npx prisma migrate dev

# æ•°æ®åº“æŸ¥çœ‹
npx prisma studio

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f backend

# å¤‡ä»½æ•°æ®åº“
cp backend/prisma/dev.db backup-$(date +%Y%m%d).db
```

## ğŸ› å·²çŸ¥é—®é¢˜

1. å‰ç«¯ npm install åœ¨æŸäº› Windows ç¯å¢ƒä¸‹å¯èƒ½å¡ä½ï¼Œå»ºè®®ä½¿ç”¨ Yarn æˆ–æ‰‹åŠ¨å®‰è£…
2. SQLite ä¸é€‚åˆé«˜å¹¶å‘ç”Ÿäº§ç¯å¢ƒï¼ŒåæœŸå»ºè®®è¿ç§»åˆ° PostgreSQL
3. æµé‡ç»Ÿè®¡ç²¾åº¦ä¸º Byteï¼Œå¤§æµé‡æ—¶å¯èƒ½æº¢å‡º (å·²ç”¨ BigInt)

## ğŸ“‹ å¼€å‘è®¡åˆ’

- [ ] å®Œæˆå‰ç«¯æ„å»ºå’Œæµ‹è¯•
- [ ] æ·»åŠ é‚®ç®±éªŒè¯åŠŸèƒ½
- [ ] é›†æˆæ”¯ä»˜ç³»ç»Ÿ
- [ ] æ·»åŠ å®¢æˆ·ç«¯è®¢é˜…æ”¯æŒ
- [ ] å®ç°èŠ‚ç‚¹å¥åº·æ£€æŸ¥
- [ ] æ·»åŠ ç®¡ç†åå°ç»Ÿè®¡å›¾è¡¨

## ğŸ‘¨â€ğŸ’» å¼€å‘è€…

- **ç›‘ç£è€…**: ğŸ¦ å°é¾™è™¾
- **å¼€å‘è€…**: ä½•

## ğŸ“„ è®¸å¯è¯

MIT License
